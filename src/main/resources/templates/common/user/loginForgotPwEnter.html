<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="~{layout/comm_default}">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1 maximum-scale=1 minimum-scale=1" />
<script th:inline="javascript" type="text/javascript">
  var loginforgotpwenter
  $(document).ready(function(){
    loginforgotpwenter = new Vue({
      el: '#app',
      data: {
        userEmail:[[${userEmail}]],
        userInfo:{
            prePw:'',
            afterPw:''
        }
      },
      methods: {
        savePw(e){
            e.preventDefault();
            let _self = this;
            if (!!!_self.userInfo.prePw || !!!_self.userInfo.afterPw) {
                cmmAlert("비밀번호 입력하세요.")
                return;
            } else if (_self.userInfo.prePw !== _self.userInfo.afterPw) {
                cmmAlert("비밀번호 같지 않습니다.확인 후 다시 입력하세요")
            }
            _self.pwInit();

        },
        pwInit(){
            let _self = this;
            let url = "/api/loginForgotPwEnter";
            let params = {email:_self.userEmail,pwd:_self.userInfo.afterPw,passwd1:_self.userInfo.prePw,passwd2:_self.userInfo.afterPw}
            axiosCall('put', url, params, res =>{
                if (!!res.data) {
                    cmmAlert(res.data)
                    window.location.href = "/user/login"
                }
            }, "");
        }
      }
    })
  });
</script>
</head>
<body>
	<section class="wrap" layout:fragment="content" id="app"  v-cloak>
		<div class="page-head">
            <!-- content -->
            <div class="page-content">
                <div class="sub_title">
                    <div class="section_inner">
                        <h2>비밀번호 찾기</h2>
                        <span>시스템에 가입된 비밀번호 찾기를 진행합니다.</span>
                    </div>
                </div>
                <div id="lay_find" class="page_find">
                    <div class="section_inner">
                        <div id="typeC" class="tab_con">
                            <div class="txt_box">
                                <b>변경할 비밀번호를 입력해 주세요.</b>
                            </div>
                            <!-- 비밀번호찾기 폼 -->
                            <form action="">
                                <fieldset>
                                    <legend>비밀번호찾기 폼</legend>
                                    <div class="form_con">
                                        <div class="box">
                                            <h4>새로운 비밀번호</h4>
                                            <div class="input_wrap">
                                                <div class="input_box">
                                                    <input type="password" id="prePw" name="prePw" v-model="userInfo.prePw">
                                                </div>
                                            </div>
                                        </div>
                                        <div class="box">
                                            <h4>비밀번호 확인</h4>
                                            <div class="input_wrap">
                                                <div class="input_box">
                                                    <input type="password" id="afterPw" name="afterPw" v-model="userInfo.afterPw">
                                                </div>
                                            </div>
                                        </div>
                                        <div class="pop-btn-box">
                                            <a href="/user/login" class="btn-pop-bottom">취소</a>
                                            <a href="#" class="btn-pop-bottom" @click="savePw">확인</a>
                                        </div>
                                    </div>
                                </fieldset>
                            </form>
                            <!-- //비밀번호찾기 폼 -->
                        </div>
                    </div>
                </div>
            </div>
            <!-- //content -->
        </div>
    </section>
</body>
</html>
